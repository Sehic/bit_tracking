@(offices: List[PostOffice])
@adminmain("api"){


    <div id="map" style="position: relative; height: 700px; width: auto"></div>
    <div id="directionsPanel"></div>


    <script >
    $(document).ready(function(){
        initMap();
    });

var officeAddresses = [];

        function initMap() {
        @for(office <- offices) {
            officeAddresses.push("@office.address");
        }

  var map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: 41.85, lng: -87.65},
    scrollwheel: false,
    zoom: 7
  });

  var directionsService = new google.maps.DirectionsService();

var renderOptions = { draggable: true };
var directionDisplay = new google.maps.DirectionsRenderer(renderOptions);

//set the directions display service to the map
directionDisplay.setMap(map);
//set the directions display panel
//panel is usually just and empty div.
//This is where the turn by turn directions appear.
directionDisplay.setPanel(directionsPanel);

//build the waypoints
//free api allows a max of 9 total stops including the start and end address
//premier allows a total of 25 stops.
var items = [officeAddresses[1]];
var waypoints = [];
for (var i = 0; i < items.length; i++) {
    var address = items[i];
    if(address !== "") {
        waypoints.push({
            location: address,
            stopover: true
        });
    }
}

//set the starting address and destination address
var originAddress = officeAddresses[0];
var destinationAddress = officeAddresses[2];

//build directions request
var request = {
            origin: originAddress,
            destination: destinationAddress,
            waypoints: waypoints, //an array of waypoints
            optimizeWaypoints: true, //set to true if you want google to determine the shortest route or false to use the order specified.
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };

//get the route from the directions service
directionsService.route(request, function (response, status) {
    if(status == google.maps.DirectionsStatus.OK) {
        directionDisplay.setDirections(response);
    }
    else {
        //handle error
    }
});
}
    </script>
}